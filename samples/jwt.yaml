openapi: 3.0.0
info:
  description: "This is a Todo manager server and an Authorization JWT server.  You can find out the Github project at [NodeJwtAndTodoServer](https://github.com/gian89/NodeJwtAndToDoServer)"
  version: "1.0.0"
  title: Swagger NodeJwtAndTodoServer
  termsOfService: 'http://swagger.io/terms/'
  contact:
    email: "s.gianmarco@gmail.com"
  license:
    name: Apache 2.0
    url: 'http://www.apache.org/licenses/LICENSE-2.0.html'
servers:
  # Added by API Auto Mocking Plugin
  - description: SwaggerHub API Auto Mocking
    url: https://virtserver.swaggerhub.com/s.gianmarc/NodeJwtAndTodoServe/1.0.0
  - description: Node server on your PC
    url: "http://localhost:3001"
tags:
  - name: toDo
    description: How to manage your Todo
    externalDocs:
      description: Find out more
      url: 'http://swagger.io'
  - name: user
    description: Operations about user
    externalDocs:
      description: Find out more
      url: 'http://swagger.io'
paths:
  /getTask:
    get:
      tags:
        - toDo
      summary: Returns all the task in the DB
      description: Returns all the task in the DB
      operationId: getTask
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TaskArray'
            application/xml:
              schema:
                $ref: '#/components/schemas/TaskArray'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
            application/xml:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '400':
          description: expired token
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
            application/xml:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '500':
          description: internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
            application/xml:
              schema:
                $ref: '#/components/schemas/ApiResponse'
      security:
        - bearerAuth: []
  /addTask:
    post:
      tags:
        - toDo
      summary: Add a task
      description: Add a task to the DB
      operationId: addTask
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Task'
            application/xml:
              schema:
                $ref: '#/components/schemas/Task'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
            application/xml:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '400':
          description: expired token
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
            application/xml:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '500':
          description: internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
            application/xml:
              schema:
                $ref: '#/components/schemas/ApiResponse'
      security:
        - bearerAuth: []
      requestBody:
        $ref: '#/components/requestBodies/AddTask'
  /deleteTask:
    delete:
      tags:
        - toDo
      summary: Deletes a task
      description: Delete a task by ID
      operationId: deleteTask
      parameters:
        - name: id
          in: query
          description: Task id to delete
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
            application/xml:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
            application/xml:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '400':
          description: expired token
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
            application/xml:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '500':
          description: internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
            application/xml:
              schema:
                $ref: '#/components/schemas/ApiResponse'
      security:
        - bearerAuth: []
  /getTaskById:
    get:
      tags:
        - toDo
      summary: Find a task by Id
      description: Find a task by Id
      operationId: getTaskById
      parameters:
        - name: id
          in: query
          description: Task id to delete
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TaskArray'
            application/xml:
              schema:
                $ref: '#/components/schemas/TaskArray'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
            application/xml:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '400':
          description: expired token
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
            application/xml:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '500':
          description: internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
            application/xml:
              schema:
                $ref: '#/components/schemas/ApiResponse'
      security:
        - bearerAuth: []
  /getTaskByUsername:
    get:
      tags:
        - toDo
      summary: Find a task by username
      description: Find a task by username
      operationId: getTaskByUsername
      parameters:
        - name: username
          in: query
          description: username of the task owner
          required: true
          schema:
            type: string
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TaskArray'
            application/xml:
              schema:
                $ref: '#/components/schemas/TaskArray'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
            application/xml:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '400':
          description: expired token
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
            application/xml:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '500':
          description: internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
            application/xml:
              schema:
                $ref: '#/components/schemas/ApiResponse'
      security:
        - bearerAuth: []
  /updateTask:
    put:
      tags:
        - toDo
      summary: Update a task
      description: Update a task to the DB
      operationId: updateTask
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Task'
            application/xml:
              schema:
                $ref: '#/components/schemas/Task'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
            application/xml:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '400':
          description: expired token
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
            application/xml:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '500':
          description: internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
            application/xml:
              schema:
                $ref: '#/components/schemas/ApiResponse'
      security:
        - bearerAuth: []
      requestBody:
        $ref: '#/components/requestBodies/Task'
  /login:
    post:
      tags:
        - user
      summary: Login
      description: Login
      operationId: login
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserInfo'
            application/xml:
              schema:
                $ref: '#/components/schemas/UserInfo'
        '401':
          description: Incorrect Password
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
            application/xml:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '404':
          description: User does not exist
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
            application/xml:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '500':
          description: internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
            application/xml:
              schema:
                $ref: '#/components/schemas/ApiResponse'
      requestBody:
        $ref: '#/components/requestBodies/User'
  /registerUser:
    post:
      tags:
        - user
      summary: Add a new user
      description: Add a new user
      operationId: registerUser
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserObject'
            application/xml:
              schema:
                $ref: '#/components/schemas/UserObject'
        '409':
          description: Email Already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
            application/xml:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '500':
          description: internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
            application/xml:
              schema:
                $ref: '#/components/schemas/ApiResponse'
      requestBody:
        $ref: '#/components/requestBodies/User'
  /checkAccessToken:
    get:
      tags:
        - user
      summary: Check the access token validity
      description: Check the access token validity
      operationId: checkAccessToken
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenInfo'
            application/xml:
              schema:
                $ref: '#/components/schemas/TokenInfo'
        '401':
          description: Invalid  token
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
            application/xml:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '400':
          description: expired token
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
            application/xml:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '500':
          description: internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
            application/xml:
              schema:
                $ref: '#/components/schemas/ApiResponse'
      security:
        - bearerAuth: []
  /refreshAccessToken:
    get:
      tags:
        - user
      summary: Get new access token using the refresh token
      description: Get new access token using the refresh token
      operationId: refreshAccessToken
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AccessToken'
            application/xml:
              schema:
                $ref: '#/components/schemas/AccessToken'
        '401':
          description: Invalid  token
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
            application/xml:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '400':
          description: expired token
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
            application/xml:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '500':
          description: internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
            application/xml:
              schema:
                $ref: '#/components/schemas/ApiResponse'
      security:
        - refreshBearerAuth: []
  /getUsers:
    get:
      tags:
        - user
      summary: Returns all the user in the DB
      description: Returns all the user in the DB. NO SECURITY. Just for testing
      operationId: getUsers
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserObjectArray'
            application/xml:
              schema:
                $ref: '#/components/schemas/UserObjectArray'
        '500':
          description: internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
            application/xml:
              schema:
                $ref: '#/components/schemas/ApiResponse'
      security:
        - bearerAuth: []
externalDocs:
  description: Find out more about Swagger
  url: 'http://swagger.io'
components:
  schemas:
    Task:
      type: object
      properties:
        id:
          type: integer
          format: int64
        username:
          type: string
          description: Username
        text:
          type: string
          description: task description
        date:
          type: string
          format: date-time
        status:
          type: string
          description: Order Status
          enum:
            - toDo
            - done
      xml:
        name: Task
    TaskArray:
      type: array
      items:
        $ref: '#/components/schemas/Task'
    AddTask:
      type: object
      properties:
        username:
          type: string
          description: Username
        text:
          type: string
          description: task description
        date:
          type: string
          format: date-time
        status:
          type: string
          description: Order Status
          enum:
            - toDo
            - done
      xml:
        name: AddTask
    User:
      type: object
      properties:
        username:
          type: string
          description: Username
        password:
          type: string
          description: password
      xml:
        name: User
    UserObject:
      type: object
      properties:
        username:
          type: string
          description: Username
        password:
          type: string
          description: password
        id:
          type: integer
          format: int64
      xml:
        name: UserObject
    UserObjectArray:
      type: array
      items:
        $ref: '#/components/schemas/UserObject'
    UserInfo:
      type: object
      properties:
        user:
          items:
            $ref: '#/components/schemas/User'
        access_token:
          type: string
          description: Access Token
        expires_in:
          type: integer
          format: int64
        refresh_token:
          type: string
          description: Refresh Token
      xml:
        name: UserInfo
    TokenInfo:
      type: object
      properties:
        id:
          type: integer
          format: int64
        username:
          type: string
          description: Username
        accessToken:
          type: string
          description: access token status
      xml:
        name: TokenInfo
    AccessToken:
      type: object
      properties:
        accessToken:
          type: string
          description: access token
      xml:
        name: AccessToken
    ApiResponse:
      type: object
      properties:
        status:
          type: integer
          format: int32
        message:
          type: string
  requestBodies:
    Task:
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Task'
        application/xml:
          schema:
            $ref: '#/components/schemas/Task'
      description: Complete Task object
      required: true
    AddTask:
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/AddTask'
        application/xml:
          schema:
            $ref: '#/components/schemas/AddTask'
      description: Task object without Id
      required: true
    User:
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/User'
        application/xml:
          schema:
            $ref: '#/components/schemas/User'
      description: User auth info
      required: true
    UserArray:
      content:
        application/json:
          schema:
            type: array
            items:
              $ref: '#/components/schemas/User'
      description: List of user object
      required: true
    UserInfo:
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/UserInfo'
        application/xml:
          schema:
            $ref: '#/components/schemas/UserInfo'
      description: User complete info
      required: true
  securitySchemes:
    bearerAuth:            
      type: http
      scheme: bearer
      bearerFormat: JWT    
    refreshBearerAuth:           
      type: http
      scheme: bearer
      bearerFormat: JWT